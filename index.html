<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Feed Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script type="module" src="/main.js"></script>

    <style>
      body {
        transition: background-color 0.3s, color 0.3s;
      }
    </style>
  </head>
  <body
    x-data="themeSwitcher()"
    x-init="init()"
    :class="dark ? 'dark bg-[#101010] text-gray-100' : 'bg-gray-100 text-gray-800'"
    class="min-h-screen mx-4"
  >
    <header
      :class="dark ? 'bg-[#222222]/40 shadow-white/15':'bg-white shadow-black/15'"
      class="shadow-sm -mx-4"
    >
      <div
        class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between"
      >
        <h1 class="text-xl font-bold">TechNews</h1>
        <nav class="space-x-4">
          <a href="#api-doc" class="hover:text-blue-600 font-medium">API-Doc</a>
          <button
            @click="toggleTheme"
            class="font-medium hover:text-blue-600"
            x-text="dark ? '☀️ Light Mode' : '🌙 Dark Mode'"
          ></button>
        </nav>
      </div>
    </header>

    <div
      x-data="feedApp()"
      x-init="loadFeed();loadResume()"
      class="max-w-5xl mx-auto mt-10"
    >
      <section
        x-data="{ showSection: true }"
        :class="dark ? 'border-white/40':'border-black/40'"
        class="mb-10 border-b-2 border-black/40 pb-6"
      >
        <button
          @click="showSection = !showSection"
          class="font-medium text-3xl mb-5 flex items-center gap-2 hover:text-red-700"
        >
          <span
            :class="showSection ? 'rotate-90' : 'rotate-0'"
            class="transition-transform duration-200 text-[1.6rem]"
            >➤</span
          >
          <span>Rangkuman Berita</span>
        </button>

        <div x-show="showSection">
          <template x-for="(data, key) in resumes.resume" :key="key">
            <div>
              <p
                class="text-base md:text-lg text-justify mb-2 mr-1"
                x-text="data.result"
              ></p>
              <p class="text-base md:text-lg text-justify mb-5 mr-1">
                <span class="font-medium">Sumber: </span>
                <a
                  :href="data.source"
                  x-text="data.source"
                  class="text-red-700 hover:text-red-400 hover:underline"
                ></a>
              </p>
            </div>
          </template>

          <template x-if="!Object.keys(resumes).length">
            <p class="text-gray-500 text-center">Belum ada resume.</p>
          </template>
        </div>
      </section>

      <div class="mb-8">
        <h1 class="font-medium text-3xl mb-2">Daftar Berita</h1>
        <p class="pl-[0.2rem] text-lg">Berita 7 hari terakhir</p>
      </div>

      <nav class="flex flex-wrap gap-2 mb-6">
        <template x-for="(items, key) in feeds" :key="key">
          <button
            @click="selected = key"
            class="px-4 py-2 rounded text-sm font-medium"
            :class="selected === key
            ? (dark ? 'bg-green-500 text-black' : 'bg-blue-600 text-white')
            : (dark ? 'bg-white/10 text-white border border-black hover:bg-white/15' : 'bg-white text-gray-800 border border-gray-300 hover:bg-gray-100')"
            x-text="key"
          ></button>
        </template>
      </nav>

      <div
        :class="dark ? 'bg-white/10' : 'bg-white'"
        class="rounded shadow p-4"
      >
        <template x-if="feeds[selected] && feeds[selected].length">
          <ul class="space-y-3">
            <template x-for="item in feeds[selected]" :key="item.link">
              <li>
                <a
                  :href="item.link"
                  target="_blank"
                  :class="dark ? 'text-green-500' :'text-blue-600'"
                  class="hover:underline font-semibold"
                  x-text="item.title"
                ></a>
                <div
                  :class="dark ? ' text-gray-300/80' :'text-gray-500'"
                  class="text-sm"
                  x-text="new Date(item.published).toLocaleString()"
                ></div>
              </li>
            </template>
          </ul>
        </template>
        <template x-if="!feeds[selected] || feeds[selected].length === 0">
          <p
            :class="dark ? ' text-gray-300/80' :'text-gray-500'"
            class="text-center"
          >
            Tidak ada data pada sumber ini seminggu terakhir.
          </p>
        </template>
      </div>
    </div>

    <footer
      class="mt-[2.5rem] md:mt-[3.5rem] mb-5 mb-7 text-center text-sm flex justify-center"
    >
      <div
        :class="dark ? 'bg-white/5 text-white/80 border-white/10':'bg-white text-gray-600'"
        class="px-8 border-2 py-2"
      >
        Made by
        <span
          :class="dark ? ' text-white':'text-gray-800'"
          class="font-semibold"
          >hq.han</span
        >
        powered with AlpineJS and Tailwind V4 &copy; 2025
      </div>
    </footer>
  </body>
</html>
